<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>DreamLand Dan</title>
</head>
<body>
<canvas id="ctx" width="1584" height="884" style="z-index:2"></canvas>
<script>
var cv = document.getElementById("ctx");
var ctx = cv.getContext('2d');

var menuCheck = true;
var buildCheck = false;
var mouse = {x:0,y:0};

var key = [];

var playerObj = {
	posY: 600,
	posX: 10,
	height: 138,
	width: 124,
	jumpStrength: 20,
	jumpDecay: 0.5,
	speed: 5
}

var isAttack = false;
var isDucking = false;
var isMoveLeft = false;
var isMoveRight = false;
var isJump = false;

// event listeners for key's and click's
window.addEventListener("keydown", keyDown, false);
window.addEventListener("keyup", keyUp, false);

//loadHandler();
var image = new Image();	
image.addEventListener("load", loadHandler, false);
image.src = "https://cloud.githubusercontent.com/assets/8864180/4445341/959aebc2-47f8-11e4-847c-787805f7d18a.png";

var background = new Image();	
background.addEventListener("load", loadHandler, false);
background.src = "https://cloud.githubusercontent.com/assets/8864180/4586542/2f30a63c-5019-11e4-9b68-9c892cc6df07.png";

var llama_left = new Image();	
var llama_right = new Image();
llama_left.src = "https://cloud.githubusercontent.com/assets/8864180/4586896/82814c90-5020-11e4-992b-ad73f2ed03be.png";
llama_right.src = "https://cloud.githubusercontent.com/assets/8864180/4586897/8285871a-5020-11e4-94fd-a55f2a82e864.png";





function menu(e)
{
	var tempStartH;
	var tempStartW;
	
	if(e.layerX || e.layerY == 0){
		mouse.x = e.pageX - cv.offsetLeft;
		mouse.y = e.pageY - cv.offsetTop;	
	}
	
	if(mouse.x < 930 && mouse.y < 650 && mouse.x > 540 && mouse.y > 440 && menuCheck==true)
	{
		buildCheck=false;
		menuCheck=false;
		loadHandler();
	}
}

function loadHandler()
{	
	if(menuCheck == true)
	{
		if(buildCheck == false)
		{
			image.src = "https://cloud.githubusercontent.com/assets/8864180/4445341/959aebc2-47f8-11e4-847c-787805f7d18a.png";
			ctx.drawImage(image,0,0,1600,900);
			buildCheck=true;		
		}
		document.onmousedown = menu;
	}
	else
	{	
		if(buildCheck == false)
		{
			ctx.clearRect(0,0,1600,900);
			buildCheck = true;
			setInterval(gameScreen, 1000/50);
			background.src = "https://cloud.githubusercontent.com/assets/8864180/4586542/2f30a63c-5019-11e4-9b68-9c892cc6df07.png";
			ctx.drawImage(background,0,0,1600,900);
		}
	}
}

function gameScreen()
{
	update();
	render();
}

function update()
{
	//SpaceBar
	if(key[32])
	{
		isAttack = true;
	}
	//W
	if(key[87])
	{
		if(!isJump)
		{
			playerObj.posY = 599;
			isJump = true;
		}	
	}
	//A
	if(key[65])
	{
		isMoveLeft = true;
	}
	//S
	if(key[83])
	{
		isDucking = true;
	}
	//D
	if(key[68])
	{
		isMoveRight = true;
	}
	
	//SpaceBar
	if(!key[32])
	{
		isAttack = false;
	}
	//W
	
	//A
	if(!key[65])
	{
		isMoveLeft = false;
	}
	//S
	if(!key[83])
	{
		isDucking = false;
	}
	//D
	if(!key[68])
	{
		isMoveRight = false;
	}
	
	// Preform actions
	if(isJump)
	{
		if(playerObj.posY > 600)
		{
			playerObj.jumpDecay = .5;
			playerObj.jumpStrength = 20;
			playerObj.posY = 600;
			isJump = false;
		}
		//Gravity equation...
		else if(playerObj.posY != 600)
		{
			// constantly updates playerOne's Y position
			playerObj.posY -= (playerObj.jumpStrength - playerObj.jumpDecay);
			// constantly increases the amount of pull downwards by one. 
			playerObj.jumpDecay += 1;
		}
	}
	
	if(isMoveLeft)
	{
		playerObj.posX -= playerObj.speed;
	}
	
	if(isMoveRight)
	{
		console.log("Yep");
		playerObj.posX += playerObj.speed;
	}
	
	if(isDucking)
	{
		playerObj.heigth = playerObj.heigth/2;
	}
	
	if(isAttack)
	{
	
	}
}

function render()
{
	ctx.drawImage(background,0,0,1600,900);
	
	if(!isMoveLeft)
	ctx.drawImage(llama_right,playerObj.posX, playerObj.posY);
	
	if(isMoveLeft)
		ctx.drawImage(llama_left,playerObj.posX, playerObj.posY);

	
}

function keyDown(e)
{
		key[e.keyCode] = true;
}

function keyUp(e)
{
		delete key[e.keyCode];
}

</script>
</body>
</html>
